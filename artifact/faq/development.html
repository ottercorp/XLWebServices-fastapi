<!DOCTYPE html>
<html lang=" en-US">

<head>


    <meta charset="UTF-8">

    <!-- Begin Jekyll SEO tag v2.8.0 -->
    <title>Development FAQ | faq</title>
    <meta name="generator" content="Jekyll v3.9.2"/>
    <meta property="og:title" content="Development FAQ"/>
    <meta property="og:locale" content="en_US"/>
    <meta name="description" content="卫月框架常见问题解答和知识库"/>
    <meta property="og:description" content="卫月框架常见问题解答和知识库"/>
    <link rel="canonical" href="/faq/development.html"/>
    <meta property="og:url" content="/faq/development.html"/>
    <meta property="og:site_name" content="faq"/>
    <meta property="og:type" content="website"/>
    <meta name="twitter:card" content="summary"/>
    <meta property="twitter:title" content="Development FAQ"/>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebPage",
            "description": "卫月框架常见问题解答和知识库",
            "headline": "Development FAQ",
            "url": "/faq/development.html"
        }</script>
    <!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
          type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/faq/assets/css/style.css?v=545445c1b5606335a65518c9b282efaebf1b727a">

    <style>
        .page-header {
            background-image: linear-gradient(120deg, #132f46, #378dff) !important;
            background-color: #378dff !important;
        }

        .main-content h1,
        .main-content h2,
        .main-content h3,
        .main-content h4,
        .main-content h5,
        .main-content h6 {
            color: #2f89d6 !important;
        }
    </style>
</head>

<body>
<header class="page-header" role="banner">
    <h1 class="project-name"><a href="#" style="text-decoration: none;color: #fff;">XIVLauncherCN 问答与帮助</a></h1>
    <h2 class="project-tagline">卫月框架常见问题解答和知识库</h2>

    <a href="https://goatcorp.github.io/" class="btn">XIVLauncher 项目主页（国际服）</a>
    <a href="/Launcher/Download" class="btn">下载 XIVLauncherCN</a>
    <a href="https://bbs.tggfl.com/topic/32/dalamud" class="btn">下载卫月框架（国服）</a>
    <a href="/faq/" class="btn">问答与帮助</a>


</header>

<main id="content" class="main-content" role="main">
    <h1 id="development-faq">Development FAQ</h1>

    <h2 id="table-of-contents">Table of Contents</h2>

    <h3 id="getting-started">Getting started</h3>

    <ul>
        <li><a href="#q-how-do-i-get-started">How do I get started?</a></li>
        <li><a href="#q-where-do-i-ask-for-help">Where do I ask for help?</a></li>
        <li><a href="#q-how-do-i-hot-reload-my-plugin">How do I hot-reload my plugin?</a></li>
        <li><a href="#q-how-do-i-debug-my-plugin-andor-the-game">How do I debug my plugin and/or the game?</a></li>
        <li><a href="#q-how-do-i-use-ffxivclientstructs-in-my-own-code">How do I use FFXIVClientStructs in my own code?</a></li>
    </ul>

    <h3 id="updates">Updates</h3>

    <ul>
        <li><a href="#q-what-happens-when-theres-an-api-version-bump">What happens when there’s an API version bump?</a></li>
        <li><a href="#q-how-can-i-stay-up-to-date-with-api-changes">How can I stay up to date with API changes?</a></li>
        <li><a href="#q-what-is-the-net5-upgrade">What is the .NET5 upgrade?</a></li>
        <li><a href="#q-how-do-i-fix-nothing-inherits-from-idalamudplugin">How do I fix <code class="language-plaintext highlighter-rouge">Nothing inherits from IDalamudPlugin</code>?</a></li>
        <li><a href="#q-what-happens-when-the-game-is-updated">What happens when the game is updated?</a></li>
    </ul>

    <h3 id="restrictions">Restrictions</h3>

    <ul>
        <li><a href="#q-我可以在我的插件中做什么">我可以在我的插件中做什么？</a></li>
        <li><a href="#q-why-do-you-discourage-certain-types-of-plugins">Why do you discourage certain types of plugins?</a></li>
        <li><a href="#q-are-there-any-performance-constraints-to-be-aware-of">Are there any performance constraints to be aware of?</a></li>
    </ul>

    <h3 id="development">Development</h3>

    <ul>
        <li><a href="#q-how-do-the-services-in-dalamud-work">How do the services in Dalamud work?</a></li>
        <li><a href="#q-what-are-the-currently-available-dalamud-services">What are the currently available Dalamud services?</a></li>
        <li><a href="#q-how-do-i-convert-from-world-coordinates-to-map-coordinates-and-vice-versa">How do I convert from world coordinates to map coordinates and vice versa?</a></li>
    </ul>

    <h3 id="reverse-engineering">Reverse engineering</h3>

    <ul>
        <li><a href="#q-how-do-i-get-started-with-reverse-engineering-the-game-so-that-i-can-do-things-dalamud-doesnt-expose">How do I get started with reverse-engineering the game so that I can do
            things Dalamud doesn’t expose?</a></li>
        <li><a href="#q-how-do-i-hook-a-game-function">How do I hook a game function?</a></li>
    </ul>

    <hr/>

    <h2 id="getting-started-1">Getting started</h2>

    <h3 id="q-how-do-i-get-started">Q: How do I get started?</h3>

    <p>The majority of the XIVLauncher and Dalamud ecosystem is written in C# for its usability, convenience, and robustness. It is recommended that anything you work on is also in C#, unless you’re
        working on something with a significant amount of interoperation with native code (in which C++/CLI may be useful) or you’re experimenting with other .NET languages.</p>

    <p>To get started, you’ll want to get the latest version of Visual Studio found <a href="https://visualstudio.microsoft.com/downloads/">here</a>; the Community edition will work fine. After doing
        so, you can clone any of the following projects and get to work with their Visual Studio solutions. Alternatively, you may want to use another IDE such as <a
                href="https://www.jetbrains.com/rider/">JetBrains Rider</a>.</p>

    <h4 id="dalamud-plugins">Dalamud Plugins</h4>

    <p>Plugins allow you to interact with the game and add features, modify functionality, and do much more. We ask you to be respectful of <a href="#q-what-am-i-allowed-to-do-in-my-plugin">our
        guidelines</a> to ensure that your plugin is approved into the primary repository, and to minimise the risk of action by Square Enix. You can read more about this <a
            href="#q-why-do-you-discourage-certain-types-of-plugins">here</a>.</p>

    <p>We recommend that you start by cloning one of the following templates, and then customising it to your requirements. While <code class="language-plaintext highlighter-rouge">SamplePlugin</code>
        is the most actively maintained, the others are updated as required:</p>

    <ul>
        <li><a href="https://github.com/goatcorp/SamplePlugin">https://github.com/goatcorp/SamplePlugin</a></li>
        <li><a href="https://github.com/karashiiro/DalamudPluginProjectTemplate">https://github.com/karashiiro/DalamudPluginProjectTemplate</a></li>
        <li><a href="https://github.com/lmcintyre/PluginTemplate">https://github.com/lmcintyre/PluginTemplate</a></li>
    </ul>

    <p>To distribute a plugin, it needs to be packaged correctly. This can be done manually or with DalamudPackager:</p>

    <ul>
        <li><a href="https://github.com/goatcorp/DalamudPackager">https://github.com/goatcorp/DalamudPackager</a></li>
    </ul>

    <p>When your plugin is ready for testing/release, it should be PRed over to the DalamudPlugins repo. <strong>Please place testing plugins in the testing folder</strong>.</p>

    <ul>
        <li><a href="https://github.com/goatcorp/DalamudPlugins">https://github.com/goatcorp/DalamudPlugins</a></li>
    </ul>

    <h4 id="dalamud">Dalamud</h4>

    <p>Dalamud is the core addon/plugin system. It is loaded by XIVLauncher into your game, and is responsible for loading your plugins and providing them with a core set of functionality.</p>

    <p>The Dalamud source code can be found in the repository or the project:</p>

    <ul>
        <li><a href="https://github.com/goatcorp/Dalamud">https://github.com/goatcorp/Dalamud</a></li>
    </ul>

    <p>Other assets required by Dalamud can be found here:</p>

    <ul>
        <li><a href="https://github.com/goatcorp/DalamudAssets">https://github.com/goatcorp/DalamudAssets</a></li>
    </ul>

    <p>You can find the Dalamud API page below, which also lists functions you can use in plugins.</p>

    <ul>
        <li><a href="https://goatcorp.github.io/Dalamud/api/index.html">https://goatcorp.github.io/Dalamud/api/index.html</a></li>
    </ul>

    <h4 id="xivlauncher">XIVLauncher</h4>

    <p>XIVLauncher is a custom launcher for FFXIV that offers a number of benefits, including faster launching, saved credentials, and automatically injecting Dalamud into the game.</p>

    <p>The XIVLauncher source code can be found in the repository for the project:
        <a href="https://github.com/goatcorp/FFXIVQuickLauncher">https://github.com/goatcorp/FFXIVQuickLauncher</a></p>

    <hr/>

    <h3 id="q-where-do-i-ask-for-help">Q: Where do I ask for help?</h3>

    <p>The best place to ask for help is the <a href="https://discord.gg/wwYXnzWYqY">#dev channel</a> of the Discord; we’re a helpful bunch and will do our best to answer your query as long as you
        explain what you’ve tried and looked at so far.</p>

    <hr/>

    <h3 id="q-how-do-i-hot-reload-my-plugin">Q: How do I hot-reload my plugin?</h3>

    <p>As of API 4/Dalamud 6, hot-reloading is part of Dalamud. To use it, go to Dalamud Settings &gt; Experimental &gt; Dev Plugin Locations, and then add either the folder that your plugin is in or
        the plugin itself. If you add a folder, Dalamud will attempt to load all DLLs within the folder.</p>

    <hr/>

    <h3 id="q-how-do-i-debug-my-plugin-andor-the-game">Q: How do I debug my plugin and/or the game?</h3>

    <p>To debug, you’ll need to attach a debugger to the game. This will usually be from your development environment, such as Visual Studio.</p>

    <p>However, the game has antidebug protection on by default. To turn this off, use the Dalamud dev menu (<code class="language-plaintext highlighter-rouge">/xldev</code>), then go to Dalamud &gt;
        Enable AntiDebug; this setting is persisted between launches, so you do not need to turn it on each time.</p>

    <p>Once you’ve done this, you can attach to the game with your debugger. In Visual Studio, you can go to Debug &gt; Attach to Process (Ctrl+Alt+P), and then select the FF14 process. For the full
        debugging experience, make sure to change “Attach to” to include both <code class="language-plaintext highlighter-rouge">Native code</code> and <code
                class="language-plaintext highlighter-rouge">Managed (.NET 4.x) code</code>; this will ensure that the debugger will work for both the game and for Dalamud plugins.</p>

    <p>This functionality is only supported for debugging your plugins. You will not receive support if you use it for anything else.</p>

    <p><a href="/faq/debug.html">Detailed instruction available here.</a></p>

    <hr/>

    <h3 id="q-how-do-i-use-ffxivclientstructs-in-my-own-code">Q: How do I use FFXIVClientStructs in my own code?</h3>

    <p><a href="https://github.com/aers/FFXIVClientStructs">FFXIVClientStructs</a> is a communal project to provide an interface to the game’s classes, data, and more to C# users and reverse
        engineers.</p>

    <p>To use FFXIVClientStructs in your own code, you’ll need to add a reference to it. This can be done by opening the <code class="language-plaintext highlighter-rouge">csproj</code> for your
        plugin and adding the reference with the other references:</p>

    <div class="language-xml highlighter-rouge">
        <div class="highlight"><pre class="highlight"><code>    <span class="nt">&lt;Reference</span> <span class="na">Include=</span><span class="s">"FFXIVClientStructs"</span><span
                class="nt">&gt;</span>
      <span class="nt">&lt;HintPath&gt;</span>$(AppData)\XIVLauncher\addon\Hooks\dev\FFXIVClientStructs.dll<span class="nt">&lt;/HintPath&gt;</span>
    <span class="nt">&lt;/Reference&gt;</span>
</code></pre>
        </div>
    </div>

    <p>or through right-clicking the project in VS, going to Add, and then adding an Assembly Reference to the same path. Note that you will likely need to still open the <code
            class="language-plaintext highlighter-rouge">csproj</code> after doing this to ensure that the path uses <code class="language-plaintext highlighter-rouge">$(AppData)</code> and not the
        path specific to your system.</p>

    <p>However, the version of FFXIVClientStructs included with Dalamud is not updated very frequently, and may not feature the latest changes to the GitHub repository. To use the latest version,
        you’ll need to pack it into your plugin using a tool like <a href="https://github.com/gluck/il-repack">ILRepack</a>.</p>

    <hr/>

    <h2 id="updates-1">Updates</h2>

    <h3 id="q-what-happens-when-theres-an-api-version-bump">Q: What happens when there’s an API version bump?</h3>

    <p>When there’s an API version bump, your plugin will no longer be loaded by Dalamud. To fix this, you’ll need to update to the latest version of the API by updating the JSON file for your plugin
        and repackaging your plugin for the repository.</p>

    <hr/>

    <h3 id="q-how-can-i-stay-up-to-date-with-api-changes">Q: How can I stay up to date with API changes?</h3>

    <p>The best place to stay up to date with upcoming API changes is to frequent the <a href="https://discord.gg/wwYXnzWYqY">#dev channel of the Discord</a>. Changes will be announced with notice so
        that you can adapt your plugin as appropriate.</p>

    <p>After submitting your first plugin to the repository, you will be given a Plugin Developer role so that you will be pinged whenever breaking changes occur.</p>

    <hr/>

    <h3 id="q-what-is-the-net5-upgrade">Q: What is the .NET5 upgrade?</h3>

    <p>Dalamud 6.0 has adopted .NET 5, the latest version of .NET, and has used this opportunity to improve the Dalamud API with version 4 of the API. All new plugins are on API 4 or above. If you are
        creating a new plugin, or have already updated your plugin, you can stop reading now.</p>

    <p>If you are porting an existing plugin, please consult the following links:</p>

    <ul>
        <li><em>Roadmap</em>: <a href="https://github.com/goatcorp/Dalamud/discussions/479">https://github.com/goatcorp/Dalamud/discussions/479</a></li>
        <li><em>General Breaking Changes</em>: <a href="https://github.com/goatcorp/Dalamud/discussions/458">https://github.com/goatcorp/Dalamud/discussions/458</a></li>
        <li><em>Plugin API Redesign</em>: <a href="https://github.com/goatcorp/Dalamud/discussions/474">https://github.com/goatcorp/Dalamud/discussions/474</a></li>
        <li><em>New Features</em>: <a href="https://github.com/goatcorp/Dalamud/discussions/471">https://github.com/goatcorp/Dalamud/discussions/471</a></li>
        <li><em>Plugin Manifest Changes</em>: <a href="https://github.com/goatcorp/Dalamud/discussions/457">https://github.com/goatcorp/Dalamud/discussions/457</a></li>
    </ul>

    <hr/>

    <h3 id="q-how-do-i-fix-nothing-inherits-from-idalamudplugin">Q: How do I fix <code class="language-plaintext highlighter-rouge">Nothing inherits from IDalamudPlugin</code>?</h3>

    <p>This occurs because you have the dependencies for your plugin in the same folder as the plugin (e.g. <code class="language-plaintext highlighter-rouge">Dalamud.dll</code> and such). This was
        supported prior to .NET 5, but is no longer supported.</p>

    <p>To fix this, open the <code class="language-plaintext highlighter-rouge">csproj</code> file and add <code
            class="language-plaintext highlighter-rouge">&lt;Private&gt;false&lt;/Private&gt;</code> to each of your <code class="language-plaintext highlighter-rouge">Reference</code>s like so:</p>

    <div class="language-xml highlighter-rouge">
        <div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Reference</span> <span class="na">Include=</span><span class="s">"Dalamud"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;HintPath&gt;</span>$(AppData)\XIVLauncher\addon\Hooks\dev\Dalamud.dll<span class="nt">&lt;/HintPath&gt;</span>
    <span class="nt">&lt;Private&gt;</span>false<span class="nt">&lt;/Private&gt;</span>
<span class="nt">&lt;/Reference&gt;</span>
</code></pre>
        </div>
    </div>

    <p>After doing this, clean out your output folder and rebuild. It will no longer copy the dependencies, and your plugin should now be able to load correctly.</p>

    <hr/>

    <h3 id="q-what-happens-when-the-game-is-updated">Q: What happens when the game is updated?</h3>

    <p>When the game is updated, it is likely that your plugin will stop working and/or Dalamud will refuse to load it. To fix this, you’ll need to:</p>

    <ul>
        <li>Wait for Dalamud to update to accommodate the new game version.</li>
        <li>Update your plugin to ensure it’s using the latest API version and still works with the game. Ensure that any non-Dalamud interactions with the game (e.g. direct interop, etc) have been
            updated.
        </li>
        <li>Repackage and reupload your plugin.</li>
    </ul>

    <hr/>

    <h2 id="restrictions-1">Restrictions</h2>

    <h3 id="q-我可以在我的插件中做什么">Q: 我可以在我的插件中做什么？</h3>

    <p>Dalamud 插件的开发在本质上会干扰游戏的运行并改变 Square Enix 所带来的体验。这使得限制您的插件不会做任何人类玩家无法做到的事情变得尤其重要； Dalamud 插件应该仅仅增强体验，而不是从根本上改变它。</p>

    <p>请确保您的插件不会以以下方式与游戏服务器交互：</p>

    <ul>
        <li>自动化，如轮询数据或在没有用户直接交互的情况下发出请求。</li>
        <li>超出规范，例如允许玩家通过正常方式无法实现的方法向服务器提交数据。</li>
    </ul>

    <p>违反此规定的插件将不会被 Dalamud 插件存储库接受，并且您将不会得到 Dalamud 社区的支持。</p>

    <hr/>

    <h3 id="q-why-do-you-discourage-certain-types-of-plugins">Q: Why do you discourage certain types of plugins?</h3>

    <blockquote>
        <p>Dalamud and XIVLauncher were made by me with the goal to do cool stuff with a game I love, and give others the chance to do so while making the game itself more accessible. I don’t want to
            cause harm to the game, its community or Square Enix. Plugins that fall outside of the definition of “acceptable” that we set as a collective create a divide and debate that we don’t want
            to be a part of.</p>

        <p>This stance of mine has narrowed down as XIVLauncher has gained popularity, as you may notice by going through some of the first plugins to be added.</p>

        <p>Obviously, this comes from a moral point of view, which may differ from yours - and the rules and decisions I make may sometimes seem unjustified - but I want to minimize the risk of Square
            Enix taking action and taking away the things we built, while degrading the general user experience of their game.</p>

        <p>I can’t and don’t want to control anyone that makes free software based on my work, but I would like to ask you to consider and empathize with my opinion when creating software that depends
            on Dalamud.</p>
    </blockquote>

    <ul>
        <li><a href="https://github.com/goaaats">goat</a>, the lead developer of XIVLauncher/Dalamud</li>
    </ul>

    <hr/>

    <h3 id="q-are-there-any-performance-constraints-to-be-aware-of">Q: Are there any performance constraints to be aware of?</h3>

    <p>You should generally aim to not impact game performance too much as that can degrade the experience for the player and cause other issues. A good place to start debugging performance issues is
        through the Plugin Statistics window, which can be found through Plugins &gt; Open Plugin Stats in the dev menu (<code class="language-plaintext highlighter-rouge">/xldev</code>).</p>

    <hr/>

    <h2 id="development-1">Development</h2>

    <h3 id="q-how-do-the-services-in-dalamud-work">Q: How do the services in Dalamud work?</h3>

    <p>Dalamud is composed of many services, with the <code class="language-plaintext highlighter-rouge">Dalamud.IoC.PluginInterfaceAttribute</code> attribute, that provide you access to game and
        Dalamud state. You can opt into these services by including them in the constructor of the plugin, like so,</p>

    <div class="language-csharp highlighter-rouge">
        <div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="nf">Plugin</span><span class="p">(</span>
    <span class="p">[</span><span class="nf">RequiredVersion</span><span class="p">(</span><span class="s">"1.0"</span><span class="p">)]</span> <span class="n">DalamudPluginInterface</span> <span
                    class="n">pluginInterface</span><span class="p">,</span>
    <span class="p">[</span><span class="nf">RequiredVersion</span><span class="p">(</span><span class="s">"1.0"</span><span class="p">)]</span> <span class="n">CommandManager</span> <span class="n">commandManager</span><span
                    class="p">)</span>
</code></pre>
        </div>
    </div>

    <p>or by including them as an appropriately-attributed static variables in a class, and then using the plugin interface you get in the constructor (it’s mandatory!) to initialise said class:</p>

    <div class="language-csharp highlighter-rouge">
        <div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Dalamud</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Initialize</span><span class="p">(</span><span
                    class="n">DalamudPluginInterface</span> <span class="n">pluginInterface</span><span class="p">)</span> <span class="p">=&gt;</span>
        <span class="n">pluginInterface</span><span class="p">.</span><span class="n">Create</span><span class="p">&lt;</span><span class="n">Dalamud</span><span class="p">&gt;();</span>

    <span class="p">[</span><span class="n">PluginService</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">RequiredVersion</span><span class="p">(</span><span class="s">"1.0"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">DalamudPluginInterface</span> <span class="n">PluginInterface</span> <span class="p">{</span> <span class="k">get</span><span
                    class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span
                    class="k">null</span><span class="p">!;</span>
    <span class="p">[</span><span class="n">PluginService</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">RequiredVersion</span><span class="p">(</span><span class="s">"1.0"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">static</span> <span class="n">CommandManager</span> <span class="n">Commands</span> <span class="p">{</span> <span class="k">get</span><span
                    class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span
                    class="k">null</span><span class="p">!;</span>
<span class="p">}</span>

<span class="k">public</span> <span class="nf">Plugin</span><span class="p">(</span><span class="n">DalamudPluginInterface</span> <span class="n">pluginInterface</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Dalamud</span><span class="p">.</span><span class="nf">Initialize</span><span class="p">(</span><span class="n">pluginInterface</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
        </div>
    </div>

    <hr/>

    <h3 id="q-what-are-the-currently-available-dalamud-services">Q: What are the currently available Dalamud services?</h3>

    <p>As of Dalamud 6.3, these are all of the currently available services. Please update this list if you spot a discrepancy!</p>

    <ul>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Data.DataManager.html"><code class="language-plaintext highlighter-rouge">Dalamud.Data.DataManager</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Aetherytes.AetheryteList.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Aetherytes.AetheryteList</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Buddy.BuddyList.html"><code
                class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Buddy.BuddyList</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Conditions.Condition.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Conditions.Condition</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Fates.FateTable.html"><code
                class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Fates.FateTable</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.GamePad.GamepadState.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.GamePad.GamepadState</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.JobGauge.JobGauges.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.JobGauge.JobGauges</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Keys.KeyState.html"><code
                class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Keys.KeyState</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Objects.ObjectTable.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Objects.ObjectTable</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Objects.TargetManager.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Objects.TargetManager</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.Party.PartyList.html"><code
                class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.Party.PartyList</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ClientState.ClientState.html"><code
                class="language-plaintext highlighter-rouge">Dalamud.Game.ClientState.ClientState</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Command.CommandManager.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Command.CommandManager</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.ContextMenus.ContextMenu.html"><code
                class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.ContextMenus.ContextMenu</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.Dtr.DtrBar.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.Dtr.DtrBar</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.FlyText.FlyTextGui.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.FlyText.FlyTextGui</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.PartyFinder.PartyFinderGui.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.PartyFinder.PartyFinderGui</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.Toast.ToastGui.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.Toast.ToastGui</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.ChatGui.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.ChatGui</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Gui.GameGui.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Gui.GameGui</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Libc.LibcFunction.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Libc.LibcFunction</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Network.GameNetwork.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Network.GameNetwork</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Text.SeStringHandling.SeStringManager.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Text.SeStringHandling.SeStringManager</code></a>
        </li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.ChatHandlers.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.ChatHandlers</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.Framework.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.Framework</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.SigScanner.html"><code class="language-plaintext highlighter-rouge">Dalamud.Game.SigScanner</code></a></li>
        <li><a href="https://goatcorp.github.io/Dalamud/api/Dalamud.Interface.TitleScreenMenu.html"><code class="language-plaintext highlighter-rouge">Dalamud.Interface.TitleScreenMenu</code></a></li>
    </ul>

    <hr/>

    <h3 id="q-how-do-i-convert-from-world-coordinates-to-map-coordinates-and-vice-versa">Q: How do I convert from world coordinates to map coordinates and vice versa?</h3>

    <p>Please consult the <a href="https://github.com/xivapi/ffxiv-datamining/blob/master/docs/MapCoordinates.md">ffxiv-datamining documentation on MapCoordinates</a>, which details how to convert
        between the various kinds of coordinates.</p>

    <hr/>

    <h2 id="reverse-engineering-1">Reverse engineering</h2>

    <h3 id="q-how-do-i-get-started-with-reverse-engineering-the-game-so-that-i-can-do-things-dalamud-doesnt-expose">Q: How do I get started with reverse-engineering the game so that I can do things
        Dalamud doesn’t expose?</h3>

    <p>Reverse-engineering isn’t easy, and it’s even more difficult when reversing a large game like FFXIV. It’s a large subject and hard to explore, but here are some rough pointers.</p>

    <p>Fundamentally, the game is running on your machine, which means it’s executing code constantly to run the game logic and to render the scene. In addition, it is constantly talking to the game
        server, which is what allows you to interact with other players and the world at large.</p>

    <p>If you’d like to learn more about how the game communicates with the server, your best bet is the <a href="https://github.com/SapphireServer/Sapphire">Sapphire project</a>. The Dalamud project
        generally strays away from interfering with client-server communication for the reasons outlined in <a href="#q-what-am-i-allowed-to-do-in-my-plugin">What am I allowed to do in my plugin?</a>,
        but understanding the flow may help with other things.</p>

    <p>Otherwise, you’ll be reverse-engineering the game client, as that’s what Dalamud hooks into. The game binary you have is compiled machine code; the original source code for the game is
        unavailable, which means you have to figure out what it’s doing without knowing any of the original context.</p>

    <p>To do this, you’ll need an interactive disassembler/decompiler to conduct <em>static analysis</em>. The gold standard for this is <a href="https://hex-rays.com/ida-pro/">IDA Pro</a>, but it is
        very expensive for hobbyists and most people take an approach generally frowned upon by the Maelstrom. A popular free alternative is <a href="https://ghidra-sre.org/">Ghidra</a>, which is very
        powerful and extensible, if not a little clunky. There are other disassemblers, but these are the two primarily used by the Dalamud community.</p>

    <p>Once you have your disassembler ready, you’ll need to disassemble the <code class="language-plaintext highlighter-rouge">ffxiv_dx11.exe</code> file in the game’s directory. After doing this, it
        is highly recommended that you use <a href="https://github.com/aers/FFXIVClientStructs/tree/main/ida">the excellent script provided by FFXIVClientStructs</a>; this script will automatically
        populate your disassembler’s database with community findings for the current version, saving you a great deal of time.</p>

    <p>After that, well… it’s time for you to work on the puzzle. You’ll want to find resources for how to reverse-engineer things online; there are tutorials that specifically look at reversing
        games, which may help you build up an intuition for the thought process you’ll need.</p>

    <p>Another approach you can take is <em>dynamic analysis</em>. You can attach a debugger to the game, like <a href="https://x64dbg.com/">x64dbg</a> or <a href="https://www.cheatengine.org/">Cheat
        Engine</a>, and use these to explore the game’s memory and execution at runtime (e.g. searching for a value and finding what changes it in the code). Both approaches are valid, but you’ll
        likely need to use both to make headway as they can provide context for each other.</p>

    <p>Reversing is a large and complex field, and it takes years to get proficient and recognise patterns. Asking the Discord for help is encouraged, but be aware that you have a long journey ahead
        of you regardless.</p>

    <hr/>

    <h3 id="q-how-do-i-hook-a-game-function">Q: How do I hook a game function?</h3>

    <p>Hooking a function refers to intercepting its execution, so that your code runs in lieu of or as an extension to it. This could allow you to, for example, detect when a certain action occurs
        in-game and change its behaviour.</p>

    <p>Assuming that you’ve successfully found a function you’d like to hook through reverse-engineering, Dalamud and EasyHook make hooking functions fairly easy. You’ll need the address of the
        function to hook; this can be retrieved from your disassembler, or by getting a “signature” for the function, which is a unique string of instructions that can be used to find the address.</p>

    <p>Using signatures is preferred where possible as it improves the chances of your plugin surviving a game update (as addresses always change, while signatures do not). To get a signature, you’ll
        need to look up how to do it with your preferred disassembler. For IDA, <a href="https://github.com/Caraxi/SigMaker-x64">Caraxi’s fork of SigMaker-x64</a> is recommended.</p>

    <p>If you have a signature, you will need to resolve it to an address in your code. For a traditional string-of-instruction-bytes signature, you can use <a
            href="https://goatcorp.github.io/Dalamud/api/Dalamud.Game.SigScanner.html#Dalamud_Game_SigScanner_ScanText_System_String_">ScanText</a>. For other types of signatures, please look at the
        other methods for <code class="language-plaintext highlighter-rouge">SigScanner</code> and choose an appropriate one.</p>

    <p>After that:</p>

    <ul>
        <li>Import <code class="language-plaintext highlighter-rouge">Dalamud.Hooking</code>.</li>
        <li>Create a delegate type with the same type signature as the function you’re hooking.</li>
        <li>Create a <code class="language-plaintext highlighter-rouge">Hook&lt;YourDelegateType&gt;</code> variable to represent the hook.</li>
        <li>Create a function in which your custom code will execute. It should match the type signature of the delegate.</li>
        <li>In your <code class="language-plaintext highlighter-rouge">Initialize</code> function:
            <ul>
                <li>Get the address for the function (either as-is or through a signature).</li>
                <li>Initialize your <code class="language-plaintext highlighter-rouge">Hook</code> variable by calling its constructor with the address, delegate-ified version of your custom code
                    function, and <code class="language-plaintext highlighter-rouge">this</code>.
                </li>
                <li>Enable the hook.</li>
            </ul>
        </li>
        <li>In your <code class="language-plaintext highlighter-rouge">Dispose</code> function:
            <ul>
                <li>Disable the hook.</li>
                <li>Dispose of the hook.</li>
            </ul>
        </li>
    </ul>

    <p>You should then be ready to go. An abbreviated example (only relevant portions shown) of hooking the main <code class="language-plaintext highlighter-rouge">Render</code> function for the game
        follows:</p>

    <div class="language-c# highlighter-rouge">
        <div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Dalamud.Hooking</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Dalamud.Plugin</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">SamplePlugin</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Plugin</span> <span class="p">:</span> <span class="n">IDalamudPlugin</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">=&gt;</span> <span class="s">"SamplePlugin"</span><span class="p">;</span>

        <span class="k">private</span> <span class="n">DalamudPluginInterface</span> <span class="n">pi</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">delegate</span> <span class="n">IntPtr</span> <span class="nf">RenderDelegate</span><span class="p">(</span><span class="n">IntPtr</span> <span
                    class="n">renderManager</span><span class="p">);</span>
        <span class="k">private</span> <span class="n">Hook</span><span class="p">&lt;</span><span class="n">RenderDelegate</span><span class="p">&gt;</span> <span
                    class="n">renderDelegateHook</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Initialize</span><span class="p">(</span><span class="n">DalamudPluginInterface</span> <span class="n">pluginInterface</span><span
                    class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">pi</span> <span class="p">=</span> <span class="n">pluginInterface</span><span class="p">;</span>

            <span class="c1">// Render::Manager::Render</span>
            <span class="kt">var</span> <span class="n">Signature</span> <span class="p">=</span> <span class="s">"40 53 55 57 41 56 41 57 48 83 EC 60"</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">renderAddress</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">pi</span><span
                    class="p">.</span><span class="n">TargetModuleScanner</span><span class="p">.</span><span class="nf">ScanText</span><span class="p">(</span><span class="n">Signature</span><span
                    class="p">);</span>

            <span class="k">this</span><span class="p">.</span><span class="n">renderDelegateHook</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Hook</span><span class="p">&lt;</span><span
                    class="n">RenderDelegate</span><span class="p">&gt;(</span><span class="n">renderAddress</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span
                    class="n">RenderDetour</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="n">renderDelegateHook</span><span class="p">.</span><span class="nf">Enable</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">unsafe</span> <span class="n">IntPtr</span> <span class="nf">RenderDetour</span><span class="p">(</span><span class="n">IntPtr</span> <span
                    class="n">renderManager</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">PluginLog</span><span class="p">.</span><span class="nf">Information</span><span class="p">(</span><span class="s">"Before render"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">renderDelegateHook</span><span class="p">.</span><span
                    class="nf">Original</span><span class="p">(</span><span class="n">renderManager</span><span class="p">);</span>
            <span class="n">PluginLog</span><span class="p">.</span><span class="nf">Information</span><span class="p">(</span><span class="s">"After render"</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">renderDelegateHook</span><span class="p">.</span><span class="nf">Disable</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="n">renderDelegateHook</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="n">pi</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
        </div>
    </div>

    <hr/>

    <p>Want to add a new FAQ entry? Please use the template below and PR to the main <a href="https://github.com/goatcorp/faq">FAQ repo</a></p>

    <div class="language-plaintext highlighter-rouge">
        <div class="highlight"><pre class="highlight"><code>### Basic Title
FAQ content
&lt;hr&gt;
</code></pre>
        </div>
    </div>

    <p>Then add it to the Table of Contents using <code class="language-plaintext highlighter-rouge">[Name / Title here](#anchor here) &lt;br&gt;</code></p>

    <p><a href="#table-of-contents">Return to the top</a><br/>
        <a href="https://goatcorp.github.io/faq">Return to the main Readme</a></p>


    <footer class="site-footer">
      
      <span><a href="https://github.com/ottercorp/faq">faq</a> 受 <a
              href="https://github.com/ottercorp">ottercorp</a> 维护。 <b><a
              href="/faq/support">支持我们！</a></b></span>

    </footer>
</main>
</body>

</html>